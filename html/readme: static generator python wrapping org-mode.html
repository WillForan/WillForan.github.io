<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-04-04 Mon 22:46 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>readme: static generator python wrapping org-mode</title>
<meta name="generator" content="Org mode">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body class="container">
<div id="content">
<h1 class="title">readme: static generator python wrapping org-mode</h1>


<div id="outline-container-What" class="outline-2">
<h2 id="What">What</h2>
<div class="outline-text-2" id="text-What">
<p>
This is a repo to generate html for github pages from org mode files. 
</p>

<p>
The file you are reading is both the readme and an individual "report" (linked into <code>reports/</code>) accessible from the generated index.
</p>
</div>

<div id="outline-container-Motivation" class="outline-3">
<h3 id="Motivation">Motivation</h3>
<div class="outline-text-3" id="text-Motivation">
<ul class="org-ul">
<li>Org-mode babel is the coolest thing!</li>
<li>I have a lot of git repos for one off experiments.</li>
<li>I don't know how to make literate programming work for me</li>
</ul>

<p>
If I make it easy to export org-babel, I can use it to reduce friction on one off projects and test out ways to implement literate programming
</p>
</div>
</div>
</div>


<div id="outline-container-Notes" class="outline-2">
<h2 id="Notes">Notes</h2>
<div class="outline-text-2" id="text-Notes">
</div>
<div id="outline-container-Usage" class="outline-3">
<h3 id="Usage">Usage</h3>
<div class="outline-text-3" id="text-Usage">
<p>
run <code>make</code> to read through <code>reports/*.org</code> and export to <code>html/</code>
</p>
</div>

<div id="outline-container-this%20file" class="outline-4">
<h4 id="this%20file">this file</h4>
<div class="outline-text-4" id="text-this%20file">
<p>
run tangle from <code>reports/</code> directory not top level. relative links work much better there.
</p>
</div>
</div>
</div>

<div id="outline-container-org%20mode" class="outline-3">
<h3 id="org%20mode">org mode</h3>
<div class="outline-text-3" id="text-org%20mode">
<ul class="org-ul">
<li><code>#+OPTIONS: _:{} ^:{}</code> so <code>_</code> doesn't subscript. Can still use <code>_{}</code> like<sub>this</sub></li>
<li><code>#+OPTIONS: toc:nil num:nil</code> to remove table of contents and header numbering</li>
<li><code>C-c C-e # html</code> for an org-&gt;html template</li>
<li><code>C-c .</code> to insert the date</li>
<li><code>C-c C-v t</code> to tangle files from source blocks with <code>:tangel file</code> in the header</li>
</ul>
</div>
</div>
<div id="outline-container-Todos" class="outline-3">
<h3 id="Todos">Todos</h3>
<div class="outline-text-3" id="text-Todos">
<ul class="org-ul">
<li>add tangled file and link from <code>src_blocks</code> a la <a href="https://stackoverflow.com/questions/38857751/show-tangled-file-name-in-org-mode-code-block-export">this</a> stack overflow QA.</li>
<li>code highlighting</li>
<li>add a todo/idea page</li>
<li>use <code>file_df.mt</code> and <code>file_df.date</code> to annotate updated pages. maybe use creation time to make sure it wasn't just the file-system that was updated</li>
</ul>
</div>
</div>

<div id="outline-container-Aside" class="outline-3">
<h3 id="Aside">Aside</h3>
<div class="outline-text-3" id="text-Aside">
<p>
The small python script &#x2014; <code>make_index.py</code> &#x2014; made within this document could be replaced by a <code>Makefile</code> and a few bash/perl/python one liners.
</p>
</div>
</div>
</div>

<div id="outline-container-Code" class="outline-2">
<h2 id="Code">Code</h2>
<div class="outline-text-2" id="text-Code">
<p>
The python and html template code to export org-files and render <code>index.html</code> is all tangled within this org file.
</p>

<p>
This is awkward. For this document to be meaningful, it is the only way these files should be edited.
</p>
</div>

<div id="outline-container-find%20title%20and%20date" class="outline-3">
<h3 id="find%20title%20and%20date">find title and date</h3>
<div class="outline-text-3" id="text-find%20title%20and%20date">
<ul class="org-ul">
<li>date can be in the file as <code>#+DATE:.*yyyy-mm-dd</code> or could be the modification time of the file</li>
<li>title <code>#+TITLE:.*</code> or the name of the file</li>
<li>we want to (re-)export files that have an out-of-date export file, so keep modification time info of source org file</li>
</ul>
</div>
</div>

<div id="outline-container-find%20all%20pages" class="outline-3">
<h3 id="find%20all%20pages">find all pages</h3>
<div class="outline-text-3" id="text-find%20all%20pages">
<p>
We're creating a py file in <code>../src</code>, but running this from an org file in the directory we expect all the files to already be in.
<code>../reports</code> will work for a file launched in either location. All is lost if we run the code outside of the directory it lives.
</p>

<p>
We use the function above to pull out info on the file
</p>
<div class="org-src-container">
<pre class="src src-python">tabulate(file_df.head(n=5),headers=<span style="font-style: italic;">"keys"</span>, tablefmt=<span style="font-style: italic;">"orgtbl"</span>,showindex=<span style="font-weight: bold; text-decoration: underline;">False</span>)
</pre>
</div>

<table class="table table-striped table-bordered table-condensed"
         style="width: auto;">


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-right">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">f</th>
<th scope="col" class="org-left">mt</th>
<th scope="col" class="org-left">title</th>
<th scope="col" class="org-right">date</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">cgi-startuptime.org</td>
<td class="org-left">2022-04-04 16:34:06.432610</td>
<td class="org-left">cgi-bin and interpreter startup time</td>
<td class="org-right">2021-10-22</td>
</tr>

<tr>
<td class="org-left">risk.org</td>
<td class="org-left">2021-10-22 21:26:10.164202</td>
<td class="org-left">risk</td>
<td class="org-right">2020-04-04</td>
</tr>

<tr>
<td class="org-left">gopher.org</td>
<td class="org-left">2021-10-22 21:26:10.163202</td>
<td class="org-left">gopher</td>
<td class="org-right">2019-03-15</td>
</tr>

<tr>
<td class="org-left">netflix.org</td>
<td class="org-left">2021-10-22 21:26:10.163202</td>
<td class="org-left">Netflix Usage</td>
<td class="org-right">2017-12-09</td>
</tr>

<tr>
<td class="org-left">strava.org</td>
<td class="org-left">2021-10-22 21:26:10.164202</td>
<td class="org-left">Strava Tracked Workouts</td>
<td class="org-right">2017-12-09</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-export%20pages" class="outline-3">
<h3 id="export%20pages">export pages</h3>
<div class="outline-text-3" id="text-export%20pages">
<p>
This is a weird place to be. This text (and code) is written using org-mode within emacs. 
The actual instructions are run inside python.  
</p>

<p>
We need to use python to get back into an emacs lisp environment to export to html.
</p>

<p>
Conveniently, there's a tool for this: <a href="https://github.com/nhoffman/org-export">org-export</a>!
</p>
<div class="org-src-container">
<pre class="src src-bash">org-export html --infile xxx.org --outfile yyy.html --bootstrap
</pre>
</div>

<p>
So from python, we'll call a bash script that runs emacs. 
Meanwhile, the instructions to do all of this are written in emacs. Literate programming is hard.
</p>
</div>

<div id="outline-container-bonuses" class="outline-4">
<h4 id="bonuses">bonuses</h4>
<div class="outline-text-4" id="text-bonuses">
<ul class="org-ul">
<li>include css (<code>--bootstrap</code>) without much work</li>
<li>have more control in the name of the final output html file (<code>--outname</code>).</li>
</ul>
</div>
</div>

<div id="outline-container-org-export%20configuration" class="outline-4">
<h4 id="org-export%20configuration">org-export configuration</h4>
<div class="outline-text-4" id="text-org-export%20configuration">
<p>
By default <code>org-export</code> builds <code>ess</code> and <code>org</code> from git. This was failing. 
I removed these two from <code>org-export-html.el:cli-el-get-setup</code>
</p>
</div>
</div>


<div id="outline-container-DIY%20Make%20target%20list" class="outline-4">
<h4 id="DIY%20Make%20target%20list">DIY Make target list</h4>
<div class="outline-text-4" id="text-DIY%20Make%20target%20list">
<p>
Makefile could (should) figure out what needs to be exported.
But we already have modification times. So we can compare those to the output targets to see which needs to be (re)run.
</p>
</div>
</div>

<div id="outline-container-quick%20look" class="outline-4">
<h4 id="quick%20look">quick look</h4>
<div class="outline-text-4" id="text-quick%20look">
<p>
TODO: add this to script with something like DRYRUN
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> tabulate <span style="font-weight: bold;">import</span> tabulate
tabulate(need_update[[<span style="font-style: italic;">'title'</span>,<span style="font-style: italic;">'export_date'</span>,<span style="font-style: italic;">'mt'</span>]],headers=<span style="font-style: italic;">"keys"</span>, tablefmt=<span style="font-style: italic;">"orgtbl"</span>,showindex=<span style="font-weight: bold; text-decoration: underline;">False</span>)
</pre>
</div>

<table class="table table-striped table-bordered table-condensed"
         style="width: auto;">


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">title</th>
<th scope="col" class="org-left">export_date</th>
<th scope="col" class="org-left">mt</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">readme: static generator python wrapping org-mode</td>
<td class="org-left">2022-04-04 17:19:55.509670</td>
<td class="org-left">2022-04-04 21:36:50.713842</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-Actually%20run" class="outline-4">
<h4 id="Actually%20run">Actually run</h4>
</div>
</div>
<div id="outline-container-create%20the%20index" class="outline-3">
<h3 id="create%20the%20index">create the index</h3>
<div class="outline-text-3" id="text-create%20the%20index">
<p>
The index page links to all the exported org files.
</p>
</div>


<div id="outline-container-Template" class="outline-4">
<h4 id="Template">Template</h4>
<div class="outline-text-4" id="text-Template">
<p>
We'll use a template engine &#x2014; <a href="https://bitbucket.org/akorn/wheezy.template">wheezy.template</a> because it was linked <a href="https://wiki.python.org/moin/Templating">here</a> &#x2014; to wrap generate the index page.
</p>
<div class="org-src-container">
<pre class="src src-html">@require(file_df,title)
&lt;<span style="font-weight: bold;">html</span>&gt; &lt;<span style="font-weight: bold;">head</span>&gt;
   &lt;<span style="font-weight: bold;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">@title</span>&lt;/<span style="font-weight: bold;">title</span>&gt;
   &lt;<span style="font-weight: bold;">link</span> <span style="font-weight: bold; font-style: italic;">rel</span>=<span style="font-style: italic;">"stylesheet"</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"text/css"</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"style.css"</span> /&gt;
   &lt;<span style="font-weight: bold;">link</span> <span style="font-weight: bold; font-style: italic;">rel</span>=<span style="font-style: italic;">"alternate"</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"application/rss+xml"</span> <span style="font-weight: bold; font-style: italic;">title</span>=<span style="font-style: italic;">"WFLOG RSS Feed"</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"rss.xml"</span> /&gt;
  &lt;/<span style="font-weight: bold;">head</span>&gt;
  &lt;<span style="font-weight: bold;">body</span>&gt;
    &lt;<span style="font-weight: bold;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">@title</span>&lt;/<span style="font-weight: bold;">h1</span>&gt;
    Also in &lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"gopher://www.xn--4-cmb.com"</span>&gt;gopher space&lt;/<span style="font-weight: bold;">a</span>&gt;
    &lt;<span style="font-weight: bold;">ul</span>&gt;
    @for i,f in file_df.iterrows():
        &lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"@f['uri']"</span>&gt;&lt;<span style="font-weight: bold;">time</span>&gt;@f['date']&lt;/<span style="font-weight: bold;">time</span>&gt; @f['title']&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
    @end
    &lt;/<span style="font-weight: bold;">ul</span>&gt;
    &lt;<span style="font-weight: bold;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">External</span>&lt;/<span style="font-weight: bold;">h1</span>&gt;
    &lt;<span style="font-weight: bold;">ul</span> <span style="font-weight: bold; font-style: italic;">class</span>=<span style="font-style: italic;">"info"</span>&gt;
       &lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"https://github.com/WillForan"</span>&gt;Github&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
       &lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"https://stackoverflow.com/users/1031776/will"</span>&gt;StackOverflow&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
       &lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"https://scholar.google.com/citations?user=PzX6F5oAAAAJ"</span>&gt;GoogleScholar&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
       &lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"https://www.strava.com/athletes/15036420"</span>&gt;Strava&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
    &lt;/<span style="font-weight: bold;">ul</span>&gt;
  &lt;/<span style="font-weight: bold;">body</span>&gt;
&lt;/<span style="font-weight: bold;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-Populate" class="outline-4">
<h4 id="Populate">Populate</h4>
</div>
</div>
<div id="outline-container-Gopher" class="outline-3">
<h3 id="Gopher">Gopher</h3>
<div class="outline-text-3" id="text-Gopher">
<p>
This was done by another script or by hand somewhere since lost. Tracked here (readme.org) in 20220404
</p>
</div>
<div id="outline-container-Gopher--Template" class="outline-4">
<h4 id="Gopher--Template">Template</h4>
<div class="outline-text-4" id="text-Gopher--Template">
<p>
Like html, we're using wheezy.template but there's a lot less ceremony.
</p>

<p>
Links look like <code>[0|$desc|$link|server|70]</code>
</p>
<div class="org-src-container">
<pre class="src src-html">@require(file_df)
WF log
@for i,f in file_df.iterrows():
[0|@f['date'] - @f['title']|@f['uri']|server|70]
@end
</pre>
</div>
</div>
</div>

<div id="outline-container-Gopher--Populate" class="outline-4">
<h4 id="Gopher--Populate">Populate</h4>
<div class="outline-text-4" id="text-Gopher--Populate">
<p>
We're not doing any processing or exporting. Gopher text files will be the same as org source but named .txt instead. ln here but rsync to the gopher server will copy as files.
</p>
</div>
</div>
<div id="outline-container-Inspecting" class="outline-4">
<h4 id="Inspecting">Inspecting</h4>
<div class="outline-text-4" id="text-Inspecting">
<p>
Here's what we'll be linking
</p>
<div class="org-src-container">
<pre class="src src-python">tabulate(gopher_df, headers=<span style="font-style: italic;">"keys"</span>, tablefmt=<span style="font-style: italic;">"orgtbl"</span>,showindex=<span style="font-weight: bold; text-decoration: underline;">False</span>)
</pre>
</div>

<table class="table table-striped table-bordered table-condensed"
         style="width: auto;">


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">f</th>
<th scope="col" class="org-left">title</th>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-left">ln_to</th>
<th scope="col" class="org-left">need_ln</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">cgi-startuptime.org</td>
<td class="org-left">cgi-bin and interpreter startup time</td>
<td class="org-right">2021-10-22</td>
<td class="org-left">../gopher/cgi-startuptime.txt</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-left">risk.org</td>
<td class="org-left">risk</td>
<td class="org-right">2020-04-04</td>
<td class="org-left">../gopher/risk.txt</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-left">gopher.org</td>
<td class="org-left">gopher</td>
<td class="org-right">2019-03-15</td>
<td class="org-left">../gopher/gopher.txt</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-left">netflix.org</td>
<td class="org-left">Netflix Usage</td>
<td class="org-right">2017-12-09</td>
<td class="org-left">../gopher/netflix.txt</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-left">strava.org</td>
<td class="org-left">Strava Tracked Workouts</td>
<td class="org-right">2017-12-09</td>
<td class="org-left">../gopher/strava.txt</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-left">climbingWallSPA.org</td>
<td class="org-left">Climbing Wall Route Annotation SPA</td>
<td class="org-right">2017-11-19</td>
<td class="org-left">../gopher/climbingWallSPA.txt</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-left">readme.org</td>
<td class="org-left">readme: static generator python wrapping org-mode</td>
<td class="org-right">2017-11-18</td>
<td class="org-left">../gopher/readme.txt</td>
<td class="org-left">False</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-Commit%20to%20files" class="outline-4">
<h4 id="Commit%20to%20files">Commit to files</h4>
</div>
</div>
<div id="outline-container-RSS" class="outline-3">
<h3 id="RSS">RSS</h3>
<div class="outline-text-3" id="text-RSS">
</div>
<div id="outline-container-template" class="outline-4">
<h4 id="template">template</h4>
<div class="outline-text-4" id="text-template">
<p>
The template is easy enough. needs title, url, desc, date, and cdata encoded html
</p>
<div class="org-src-container">
<pre class="src src-xml">@require(time,rss_df)
&lt;?<span style="font-weight: bold;">xml</span> <span style="font-style: italic;">version="1.0" encoding="utf-8"</span>?&gt;
&lt;<span style="font-weight: bold;">rss</span> <span style="font-weight: bold; font-style: italic;">version</span>=<span style="font-style: italic;">"2.0"</span> <span style="font-weight: bold;">xmlns</span>:<span style="font-weight: bold; font-style: italic;">content</span>=<span style="font-style: italic;">"http://purl.org/rss/1.0/modules/content/"</span>&gt;
&lt;<span style="font-weight: bold;">channel</span>&gt;
&lt;<span style="font-weight: bold;">title</span>&gt;WFLOG&lt;/<span style="font-weight: bold;">title</span>&gt;
&lt;<span style="font-weight: bold;">link</span>&gt;www.xn--cmb.com&lt;/<span style="font-weight: bold;">link</span>&gt;
&lt;<span style="font-weight: bold;">description</span>&gt;&lt;/<span style="font-weight: bold;">description</span>&gt;
&lt;<span style="font-weight: bold;">lastBuildDate</span>&gt;@time&lt;/<span style="font-weight: bold;">lastBuildDate</span>&gt;
@for i,f in rss_df.iterrows():
  &lt;<span style="font-weight: bold;">item</span>&gt;
    &lt;<span style="font-weight: bold;">title</span>&gt;@f['title']&lt;/<span style="font-weight: bold;">title</span>&gt;
    &lt;<span style="font-weight: bold;">link</span>&gt;@f['link']&lt;/<span style="font-weight: bold;">link</span>&gt;
    &lt;<span style="font-weight: bold;">description</span>&gt;@f['desc']&lt;/<span style="font-weight: bold;">description</span>&gt;
    &lt;<span style="font-weight: bold;">pubDate</span>&gt;@f['rss_date']&lt;/<span style="font-weight: bold;">pubDate</span>&gt;
    &lt;<span style="font-weight: bold;">content</span>:<span style="font-weight: bold;">encoded</span>&gt;&lt;![<span style="font-weight: bold;">CDATA</span>[ @f['cdata'] ]]&gt;&lt;/<span style="font-weight: bold;">content</span>:<span style="font-weight: bold;">encoded</span>&gt;
    &lt;<span style="font-weight: bold;">dc</span>:<span style="font-weight: bold;">creator</span>&gt;Will Foran&lt;/<span style="font-weight: bold;">dc</span>:<span style="font-weight: bold;">creator</span>&gt;
  &lt;/<span style="font-weight: bold;">item</span>&gt;
@end
&lt;/<span style="font-weight: bold;">channel</span>&gt;
&lt;/<span style="font-weight: bold;">rss</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-arrange%20data" class="outline-4">
<h4 id="arrange%20data">arrange data</h4>
<div class="outline-text-4" id="text-arrange%20data">
<p>
need to pull in all the html body. also want date like <code>Mon, 04 Apr 2022 15:22:29 -0400</code>
</p>
</div>
</div>

<div id="outline-container-write" class="outline-4">
<h4 id="write">write</h4>
<div class="outline-text-4" id="text-write">
<p>
we should limit the feed to just the most recent files. Though it's unlikely there will ever be enough text to warrent it.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2017-11-18</p>
<p class="date">Created: 2022-04-04 Mon 22:46</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
