<!DOCTYPE html>
<html>
  <head>
    <title>org-babel code alias</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
    <link rel="alternate" type="application/rss+xml" title="WFLOG RSS Feed" href="index.xml" />
    <link rel="shortcut icon" href="https://secure.gravatar.com/avatar/3fed911ae9175eaf6c4e4ec51de7e6ac?size=125">
  </head>
  <body style="max-width: 40em">

    <h1 style="font-size:bigger">org-babel code alias</h1>
    <div class="content">
      
<p>
Org-babel plotting requires additional source block arguments: <code>:results graphics file</code> on image R blocks and <code>:results output file</code> in py blocks. This is a little cumbersome, especially because I have a hard time remembering the exact incantation and might end up writing it 10s of times in a document.</p>
<p>
One particularly ugly kludge is to </p>
<ol>
<li>create new <code>src_block</code> types as aliases (eg. python=&gt; <code>pyplot</code>).</li>
<li>assign those aliases distinct <code>#PROPERty: header-args</code> </li>
</ol>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Headers
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<div class="src src-test">
<pre tabindex="0"><code class="language-test" data-lang="test">#+PROPERTY: header-args:pyplot :cache yes :session :dir /ssh:host:/path :eval noexport :results output file :session *py*
#+PROPERTY: header-args:Rplot :results graphics file :session *R* :cache yes</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Elisp
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>Org files can modify the emacs environment by sourcing elisp. But ideally this would be in <code>use-package</code> config or as it&#39;s own library. Here, using <code>#+begin_src emacs-lisp :eval yes :exports none</code></p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;org-src-lang-modes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;pyplot&#34;</span> <span style="color:#f92672">.</span> python))
</span></span><span style="display:flex;"><span>(defalias <span style="color:#e6db74">&#39;org-babel-execute:pyplot</span> <span style="color:#e6db74">&#39;org-babel-execute:python</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;org-src-lang-modes</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;Rplot&#34;</span> <span style="color:#f92672">.</span> R))
</span></span><span style="display:flex;"><span>(defalias <span style="color:#e6db74">&#39;org-babel-execute:Rplot</span> <span style="color:#e6db74">&#39;org-babel-execute:R</span>)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
R
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>with the <code>#+PROPERTY:</code> set from above we can use <code>#+begin_src Rplot :file images/exampe-Rplot.png</code></p>
<div class="src src-rplot">
<pre tabindex="0"><code class="language-rplot" data-lang="rplot">plot(1:3, c(11,10,2), &#39;l&#39;)</code></pre>
</div>
<p><img src="../images/exampe-Rplot.png" alt="../images/exampe-Rplot.png" title="../images/exampe-Rplot.png" /></p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Python
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>python&#39;s plotting isn&#39;t as seamless as R. One (slow, binary image printed to emacs buffer) solution comes from
 <a href="https://emacs.stackexchange.com/a/64667/14118">https://emacs.stackexchange.com/a/64667/14118</a> as below. Easiest to include this in the org-babel document within <code>#+begin_src python :exports none :results none :session</code>)</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pltsave</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;org hack: save to :file. header also needs &#39;:results output file&#34;</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>savefig(sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>buffer)</span></span></code></pre></div>
</div>
<p>
then using <code>#+begin_src pyplot :file ../images/example-plot.png</code></p>
<div class="src src-pyplot">
<pre tabindex="0"><code class="language-pyplot" data-lang="pyplot">plt.plot([1,2,3], [10,9,2])
pltsave()</code></pre>
</div>
<p><img src="../images/example-pyplot.png" alt="../images/example-pyplot.png" title="../images/example-pyplot.png" /></p>
</div>
</div>

      
    </div>
</body>
</html>
